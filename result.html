<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>心灵暖宝 | SCL-90测试结果 | 症状自评量表</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #4b6cb7;
            --secondary-color: #182848;
            --accent-color: #3498db;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 15px 0;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            margin-right: 10px;
        }
        
        .result-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 30px 0 50px;
        }
        
        .result-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .result-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        
        .result-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .result-overview {
            padding: 30px 40px;
            background: #f8f9fa;
            border-bottom: 1px solid #eee;
        }
        
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .overview-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .overview-card:hover {
            transform: translateY(-5px);
        }
        
        .overview-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .overview-label {
            font-size: 1rem;
            color: #666;
        }
        
        .chart-section {
            padding: 40px;
        }
        
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .chart-title {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin-bottom: 20px;
            text-align: center;
        }
        
        #factorsChart {
            max-height: 400px;
        }
        
        .factors-detail {
            padding: 0 40px 40px;
        }
        
        .factors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .factor-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-color);
        }
        
        .factor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .factor-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark-color);
        }
        
        .factor-score {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .score-low { color: var(--success-color); }
        .score-light { color: #3498db; }
        .score-medium { color: var(--warning-color); }
        .score-severe { color: var(--danger-color); }
        
        .factor-mean {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 15px;
        }
        
        .factor-description {
            font-size: 0.95rem;
            color: #555;
            margin-bottom: 15px;
        }
        
        .factor-interpretation {
            background: #f0f4f8;
            padding: 15px;
            border-radius: 10px;
            font-size: 0.9rem;
        }
        
        .interpretation-section {
            padding: 40px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }
        
        .interpretation-title {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin-bottom: 20px;
        }
        
        .interpretation-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .interpretation-content h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .interpretation-content p {
            margin-bottom: 15px;
            line-height: 1.7;
        }
        
        .interpretation-content ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .interpretation-content li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .action-buttons {
            padding: 30px 40px;
            background: #f8f9fa;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #3a56a4;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        footer {
            background: var(--dark-color);
            color: white;
            padding: 50px 0 20px;
            margin-top: 80px;
            border-radius: 40px 40px 0 0;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
        }
        
        .footer-section h4 {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--accent-color);
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-section li {
            margin-bottom: 10px;
        }
        
        .footer-section a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: var(--accent-color);
        }
        
        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
            opacity: 0.7;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .result-header {
                padding: 30px 20px;
            }
            
            .result-title {
                font-size: 1.5rem;
            }
            
            .result-subtitle {
                font-size: 1rem;
            }
            
            .result-overview, .chart-section, .factors-detail, .interpretation-section {
                padding: 20px;
            }
            
            .overview-grid {
                grid-template-columns: 1fr;
            }
            
            .factors-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media print {
            .test-info {
                display: none !important;
            }
            
            header {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            .result-container {
                box-shadow: none !important;
                margin: 0 !important;
                padding: 0 !important;
            }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo">
                    <i class="fas fa-brain"></i>
                    SCL-90测试
                </a>
                <div class="test-info">
                    <i class="fas fa-check-circle"></i> 测试已完成
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="result-container">
            <div class="result-header">
                <h1 class="result-title"><i class="fas fa-chart-line"></i> SCL-90测试结果</h1>
                <p class="result-subtitle">症状自评量表 - 专业心理评估报告</p>
            </div>
            
            <div class="result-overview">
                <h2 class="section-title">测试结果概览</h2>
                <div class="overview-grid">
                    <div class="overview-card fade-in">
                        <div class="overview-value" id="totalScore">0</div>
                        <div class="overview-label">总分</div>
                    </div>
                    <div class="overview-card fade-in">
                        <div class="overview-value" id="totalMean">0.0</div>
                        <div class="overview-label">总均分</div>
                    </div>
                    <div class="overview-card fade-in">
                        <div class="overview-value" id="positiveItems">0</div>
                        <div class="overview-label">阳性项目数</div>
                    </div>
                    <div class="overview-card fade-in">
                        <div class="overview-value" id="positiveMean">0.0</div>
                        <div class="overview-label">阳性症状均分</div>
                    </div>
                </div>
            </div>
            
            <div class="chart-section">
                <div class="chart-container fade-in">
                    <h2 class="chart-title"><i class="fas fa-chart-bar"></i> 各因子得分对比</h2>
                    <canvas id="factorsChart"></canvas>
                </div>
            </div>
            
            <div class="factors-detail">
                <h2 class="section-title">因子得分详情</h2>
                <div class="factors-grid" id="factorsGrid">
                </div>
            </div>
            
            <div class="interpretation-section">
                <h2 class="interpretation-title"><i class="fas fa-lightbulb"></i> 结果解释与建议</h2>
                <div class="interpretation-content fade-in" id="interpretationContent">
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="destroyData" class="btn btn-primary">
                    <i class="fas fa-trash"></i> 销毁记录
                </button>
                <button id="retestBtn" class="btn btn-secondary">
                    <i class="fas fa-redo"></i> 重新测试
                </button>
                <button class="btn btn-secondary" onclick="window.print()">
                    <i class="fas fa-print"></i> 打印结果
                </button>
            </div>
            
            <div id="retestModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none; justify-content: center; align-items: center; z-index: 9999; font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;">
                <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);">
                    <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.3rem;">确认重新测试</h3>
                    <p style="color: #666; margin-bottom: 30px; line-height: 1.6;">确定要开始新的测试吗？</p>
                    <div style="display: flex; gap: 15px; justify-content: flex-end;">
                        <button id="cancelRetest" style="padding: 10px 25px; border: none; border-radius: 8px; background: #95a5a6; color: white; font-weight: 600; cursor: pointer; transition: all 0.3s;">取消</button>
                        <button id="confirmRetest" style="padding: 10px 25px; border: none; border-radius: 8px; background: #2ecc71; color: white; font-weight: 600; cursor: pointer; transition: all 0.3s;">重新测试</button>
                    </div>
                </div>
            </div>
            
            <div id="destroyModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none; justify-content: center; align-items: center; z-index: 9999; font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;">
                <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);">
                    <h3 style="color: #2c3e50; margin-bottom: 20px; font-size: 1.3rem;">确认销毁记录</h3>
                    <p style="color: #666; margin-bottom: 30px; line-height: 1.6;">确定要销毁所有测试记录吗？此操作不可恢复。</p>
                    <div style="display: flex; gap: 15px; justify-content: flex-end;">
                        <button id="cancelDestroy" style="padding: 10px 25px; border: none; border-radius: 8px; background: #95a5a6; color: white; font-weight: 600; cursor: pointer; transition: all 0.3s;">取消</button>
                        <button id="confirmDestroy" style="padding: 10px 25px; border: none; border-radius: 8px; background: #e74c3c; color: white; font-weight: 600; cursor: pointer; transition: all 0.3s;">确认销毁</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="copyright">
                <p>© 心灵暖宝 | 2025 SCL-90心理健康测评系统</p>
            </div>
        </div>
    </footer>

    <script>
        if (localStorage.getItem('invite_code_valid') !== 'true') {
            window.location.href = 'index.html';
        }
    </script>
    <script>
        const SCL90_FACTORS = {
            "SOM": { "name": "躯体化", "description": "反映主观的身体不适感，包括心血管、胃肠道、呼吸等系统的主诉不适，以及头痛、背痛、肌肉酸痛等其他躯体表现。" },
            "OCD": { "name": "强迫症状", "description": "反映那些明知没有必要、但又无法摆脱的无意义的思想、冲动和行为，以及比较一般的感知障碍。" },
            "INT": { "name": "人际关系敏感", "description": "主要指某些个人不自在感和自卑感，尤其是在与他人相比较时更突出。" },
            "DEP": { "name": "抑郁", "description": "反映与临床上抑郁症状群相联系的广泛概念，忧郁苦闷的感情和心境是代表性症状。" },
            "ANX": { "name": "焦虑", "description": "指在临床上明显与焦虑症状相联系的精神症状及体验，一般指那些无法静息、神经过敏、紧张以及由此产生的躯体症状。" },
            "HOS": { "name": "敌对", "description": "主要从思维、情感及行为三方面来反映病人的敌对表现，包括厌烦、争论、摔物直至争斗和不可抑制的冲动爆发等。" },
            "PHO": { "name": "恐怖", "description": "与传统的恐怖状态或广场恐怖所反映的内容基本一致，恐惧的对象包括出门旅行、空旷场地、人群或公共场合及交通工具。" },
            "PAR": { "name": "偏执", "description": "主要是指猜疑和关系妄想等，包括投射性思维、敌对、猜疑、关系观念、妄想、被动体验和夸大等。" },
            "PSY": { "name": "精神病性", "description": "包括幻听、思维播散、被控制感、思维被插入等反映精神分裂样症状项目。" },
            "OTH": { "name": "其他", "description": "包括饮食睡眠等其他方面的症状，通常不计入因子分，但计入总分。" }
        };
        
        const FACTOR_QUESTIONS = {
            "SOM": [1,4,12,27,40,42,48,49,52,53,56,58],
            "OCD": [3,9,10,28,38,45,46,51,55,65],
            "INT": [6,21,34,36,37,41,61,69,73],
            "DEP": [5,14,15,20,22,26,29,30,31,32,54,71,79],
            "ANX": [2,17,23,33,39,57,72,78,80,86],
            "HOS": [11,24,63,67,74,81],
            "PHO": [13,25,47,50,70,75,82],
            "PAR": [8,18,43,68,76,83],
            "PSY": [7,16,35,62,77,84,85,87,88,90],
            "OTH": [19,44,59,60,64,66,89]
        };
        
        class SCL90Result {
            constructor() {
                this.answers = this.loadAnswers();
                this.results = this.calculateResults();
                this.renderResults();
            }
            
            loadAnswers() {
                const answers = localStorage.getItem('scl90_answers');
                return answers ? JSON.parse(answers) : [];
            }
            
            calculateResults() {
                if (this.answers.length === 0) {
                    return null;
                }
                
                const factorScores = {};
                let totalScore = 0;
                
                for (const [factor, questions] of Object.entries(FACTOR_QUESTIONS)) {
                    const score = questions.reduce((sum, qNum) => {
                        const answer = this.answers[qNum - 1] || 0;
                        totalScore += answer;
                        return sum + answer;
                    }, 0);
                    
                    factorScores[factor] = {
                        score: score,
                        mean: parseFloat((score / questions.length).toFixed(1)),
                        questionCount: questions.length
                    };
                }
                
                const positiveItems = this.answers.filter(answer => answer >= 1).length;
                
                const positiveMean = positiveItems > 0 ? parseFloat((totalScore / positiveItems).toFixed(1)) : 0;
                
                return {
                    totalScore: totalScore,
                    totalMean: parseFloat((totalScore / 90).toFixed(1)),
                    positiveItems: positiveItems,
                    positiveMean: positiveMean,
                    factorScores: factorScores
                };
            }
            
            renderResults() {
                if (!this.results) {
                    this.renderNoResults();
                    return;
                }
                
                this.renderOverview();
                this.renderFactors();
                this.renderInterpretation();
                
                setTimeout(() => {
                    this.renderChart();
                }, 100);
            }
            
            renderOverview() {
                document.getElementById('totalScore').textContent = this.results.totalScore;
                document.getElementById('totalMean').textContent = this.results.totalMean;
                document.getElementById('positiveItems').textContent = this.results.positiveItems;
                document.getElementById('positiveMean').textContent = this.results.positiveMean;
            }
            
            renderFactors() {
                const grid = document.getElementById('factorsGrid');
                grid.innerHTML = '';
                
                const factorsToShow = Object.entries(this.results.factorScores).filter(([key]) => key !== 'OTH');
                
                factorsToShow.forEach(([factorCode, factorData]) => {
                    const factor = SCL90_FACTORS[factorCode];
                    const card = this.createFactorCard(factorCode, factor, factorData);
                    grid.appendChild(card);
                });
            }
            
            createFactorCard(factorCode, factor, factorData) {
                const card = document.createElement('div');
                card.className = 'factor-card fade-in';
                
                const scoreClass = this.getScoreClass(factorData.mean);
                
                const interpretation = this.getFactorInterpretation(factorData.mean, factor.name);
                
                card.innerHTML = `
                    <div class="factor-header">
                        <div class="factor-name">${factor.name}</div>
                        <div class="factor-score ${scoreClass}">${factorData.mean}</div>
                    </div>
                    <div class="factor-mean">
                        因子分：${factorData.score} / 项目数：${factorData.questionCount}
                    </div>
                    <div class="factor-description">${factor.description}</div>
                    <div class="factor-interpretation">
                        <strong>解释：</strong>${interpretation}
                    </div>
                `;
                
                return card;
            }
            
            getScoreClass(mean) {
                if (mean < 1.5) return 'score-low';
                if (mean < 2.5) return 'score-light';
                if (mean < 3.5) return 'score-medium';
                return 'score-severe';
            }
            
            getFactorInterpretation(mean, factorName) {
                if (mean < 1.5) {
                    return `您在${factorName}方面的得分较低，表明您在该方面的心理症状较轻，处于正常范围。`;
                } else if (mean < 2.5) {
                    return `您在${factorName}方面的得分中等，表明您可能存在轻度的${factorName}症状，建议关注并适当调整。`;
                } else if (mean < 3.5) {
                    return `您在${factorName}方面的得分较高，表明您可能存在中度的${factorName}症状，建议寻求专业心理咨询师的帮助。`;
                } else {
                    return `您在${factorName}方面的得分很高，表明您可能存在较严重的${factorName}症状，强烈建议尽快寻求专业心理医生的帮助。`;
                }
            }
            
            renderChart() {
                const ctx = document.getElementById('factorsChart').getContext('2d');
                
                const factorsToShow = Object.entries(this.results.factorScores).filter(([key]) => key !== 'OTH');
                const labels = factorsToShow.map(([code]) => SCL90_FACTORS[code].name);
                const data = factorsToShow.map(([, data]) => data.mean);
                const colors = data.map(mean => {
                    if (mean < 1.5) return 'rgba(46, 204, 113, 0.8)';
                    if (mean < 2.5) return 'rgba(52, 152, 219, 0.8)';
                    if (mean < 3.5) return 'rgba(243, 156, 18, 0.8)';
                    return 'rgba(231, 76, 60, 0.8)';
                });
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '因子均分',
                            data: data,
                            backgroundColor: colors,
                            borderColor: colors.map(color => color.replace('0.8', '1')),
                            borderWidth: 1,
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 4,
                                title: {
                                    display: true,
                                    text: '均分（0-4）'
                                }
                            },
                            y: {
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `均分: ${context.parsed.x}`;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            renderInterpretation() {
                const content = document.getElementById('interpretationContent');
                
                const totalMean = this.results.totalMean;
                let overallInterpretation = '';
                let recommendations = '';
                
                if (totalMean < 1.5) {
                    overallInterpretation = `您的SCL-90总均分为${totalMean}，表明您的整体心理状态良好，各方面症状较轻。`;
                    recommendations = `建议您继续保持良好的生活习惯和心态，定期进行自我心理评估，以维持身心健康。`;
                } else if (totalMean < 2.5) {
                    overallInterpretation = `您的SCL-90总均分为${totalMean}，表明您可能存在轻度的心理症状，需要适当关注和调整。`;
                    recommendations = `建议您尝试一些自我调节的方法，如运动、冥想、与朋友倾诉等。如果症状持续或加重，建议寻求专业心理咨询师的帮助。`;
                } else if (totalMean < 3.5) {
                    overallInterpretation = `您的SCL-90总均分为${totalMean}，表明您可能存在中度的心理症状，需要引起重视。`;
                    recommendations = `建议您尽快寻求专业心理咨询师的帮助，进行系统的心理评估和干预。同时，注意保持良好的生活作息，避免过度压力。`;
                } else {
                    overallInterpretation = `您的SCL-90总均分为${totalMean}，表明您可能存在较严重的心理症状，需要立即关注。`;
                    recommendations = `强烈建议您尽快寻求专业心理医生或精神科医生的帮助，进行全面的评估和治疗。请不要忽视自己的心理状态，及时的专业干预可以帮助您恢复健康。`;
                }
                
                content.innerHTML = `
                    <h3><i class="fas fa-heart"></i> 整体评估</h3>
                    <p>${overallInterpretation}</p>
                    
                    <h3><i class="fas fa-lightbulb"></i> 建议与指导</h3>
                    <p>${recommendations}</p>
                    
                    <h3><i class="fas fa-info-circle"></i> 测试说明</h3>
                    <ul>
                        <li>本测试结果仅供参考，不能替代专业医疗诊断。</li>
                        <li>如果您感到持续的心理困扰，建议咨询专业心理咨询师或精神科医生。</li>
                        <li>保持良好的生活习惯、适当的运动和充足的睡眠有助于维持心理健康。</li>
                        <li>与家人和朋友保持良好的沟通，寻求社会支持也是维护心理健康的重要方式。</li>
                    </ul>
                `;
            }
            
            renderNoResults() {
                const container = document.querySelector('.result-container');
                container.innerHTML = `
                    <div class="result-header">
                        <h1 class="result-title"><i class="fas fa-exclamation-circle"></i> 暂无测试结果</h1>
                        <p class="result-subtitle">请先完成SCL-90测试</p>
                    </div>
                    <div style="padding: 50px; text-align: center;">
                        <a href="test.html" class="btn btn-primary" style="padding: 15px 40px; font-size: 1.2rem;">
                            <i class="fas fa-play-circle"></i> 开始测试
                        </a>
                    </div>
                `;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            new SCL90Result();
            
            const retestBtn = document.getElementById('retestBtn');
            const retestModal = document.getElementById('retestModal');
            const cancelRetest = document.getElementById('cancelRetest');
            const confirmRetest = document.getElementById('confirmRetest');
            
            retestBtn.addEventListener('click', () => {
                retestModal.style.display = 'flex';
            });
            
            cancelRetest.addEventListener('click', () => {
                retestModal.style.display = 'none';
            });
            
            confirmRetest.addEventListener('click', () => {
                retestModal.style.display = 'none';
                localStorage.removeItem('scl90_test_progress');
                localStorage.removeItem('scl90_answers');
                window.location.href = 'test.html';
            });
            
            const destroyDataBtn = document.getElementById('destroyData');
            const destroyModal = document.getElementById('destroyModal');
            const cancelDestroy = document.getElementById('cancelDestroy');
            const confirmDestroy = document.getElementById('confirmDestroy');
            
            destroyDataBtn.addEventListener('click', () => {
                destroyModal.style.display = 'flex';
            });
            
            cancelDestroy.addEventListener('click', () => {
                destroyModal.style.display = 'none';
            });
            
            confirmDestroy.addEventListener('click', () => {
                destroyModal.style.display = 'none';
                localStorage.removeItem('invite_code_valid');
                localStorage.removeItem('scl90_test_progress');
                localStorage.removeItem('scl90_answers');
                window.location.href = 'index.html';
            });
        });
    </script>
</body>
</html>